(function() {
    if (!window.ALL_PATTERNS) window.ALL_PATTERNS = [];

    // --- Part 5: 附點節奏與三連音 (Dotted & Triplets) ---
    const patterns = [
        {
            id: 'simple_r16_16_r16_16',
            type: 'simple',
            name: '16休+16+16休+16 (Off-beat 16ths)',
            events: [0.25, 0.75], // 只有第2和第4個16分音符發聲
            svg: `<svg viewBox="0 0 200 130"><path d="m113.37,107.9l6.8-24.08c-.99.9-2.11,1.53-3.36,1.91s-2.49.57-3.72.57c-2.03,0-3.73-.54-5.1-1.63-1.37-1.08-2.05-2.64-2.05-4.67,0-1.32.46-2.44,1.38-3.36.92-.92,2.13-1.38,3.65-1.38,1.37,0,2.49.44,3.36,1.31.87.87,1.31,2.04,1.31,3.5,0,1.04-.24,1.96-.71,2.76,0,.28.28.43.85.43,1.94,0,3.78-1.09,5.52-3.26l3.68-13.45c-.99.9-2.11,1.53-3.36,1.91s-2.49.57-3.72.57c-2.03,0-3.73-.54-5.1-1.63-1.37-1.08-2.05-2.64-2.05-4.67,0-1.32.47-2.44,1.42-3.36.94-.92,2.15-1.38,3.61-1.38s2.55.45,3.4,1.35c.85.9,1.27,2.05,1.27,3.47,0,.47-.07.96-.21,1.45-.14.5-.31.93-.5,1.31,0,.28.28.43.85.43,2.6,0,5.07-2.03,7.44-6.09h1.27l-13.38,48.01h-2.55Z"/><path d="m54.43,107.9l6.8-24.08c-.99.9-2.11,1.53-3.36,1.91s-2.49.57-3.72.57c-2.03,0-3.73-.54-5.1-1.63-1.37-1.08-2.05-2.64-2.05-4.67,0-1.32.46-2.44,1.38-3.36.92-.92,2.13-1.38,3.65-1.38,1.37,0,2.49.44,3.36,1.31.87.87,1.31,2.04,1.31,3.5,0,1.04-.24,1.96-.71,2.76,0,.28.28.43.85.43,1.94,0,3.78-1.09,5.52-3.26l3.68-13.45c-.99.9-2.11,1.53-3.36,1.91s-2.49.57-3.72.57c-2.03,0-3.73-.54-5.1-1.63-1.37-1.08-2.05-2.64-2.05-4.67,0-1.32.47-2.44,1.42-3.36.94-.92,2.15-1.38,3.61-1.38s2.55.45,3.4,1.35c.85.9,1.27,2.05,1.27,3.47,0,.47-.07.96-.21,1.45-.14.5-.31.93-.5,1.31,0,.28.28.43.85.43,2.6,0,5.07-2.03,7.44-6.09h1.27l-13.38,48.01h-2.55Z"/><g><path d="m98.21,22.1v59.2c0,2.03-.67,3.92-2.02,5.66-1.35,1.75-3.08,3.15-5.2,4.21s-4.37,1.59-6.73,1.59c-2.17,0-3.92-.55-5.24-1.66-1.32-1.11-1.98-2.61-1.98-4.5,0-1.46.43-2.88,1.27-4.25.85-1.37,1.97-2.61,3.36-3.72,1.39-1.11,2.91-1.98,4.57-2.62,1.65-.64,3.28-.96,4.89-.96,2.03,0,3.78.59,5.24,1.77V22.1h1.84Z"/><path d="m153,22.1v59.2c0,2.03-.67,3.92-2.02,5.66-1.35,1.75-3.08,3.15-5.2,4.21s-4.37,1.59-6.73,1.59c-2.17,0-3.92-.55-5.24-1.66-1.32-1.11-1.98-2.61-1.98-4.5,0-1.46.43-2.88,1.27-4.25.85-1.37,1.97-2.61,3.36-3.72,1.39-1.11,2.91-1.98,4.57-2.62,1.65-.64,3.28-.96,4.89-.96,2.03,0,3.78.59,5.24,1.77V22.1h1.84Z"/><rect x="96.37" y="22.1" width="56.64" height="5.53"/></g><rect x="96.37" y="33.16" width="56.64" height="5.53"/></svg>`
        },
        {
            id: 'simple_r16_d8',
            type: 'simple',
            name: '16休+附點8 (Rest+Dotted 8th)',
            events: [0.25], // 前短休，後長音
            svg: `<svg viewBox="0 0 200 130"><path d="m110.47,29.67h1.84c.28,1.94.64,3.65,1.06,5.13.43,1.49,1.04,2.93,1.84,4.32.8,1.39,1.86,2.89,3.19,4.5,1.42,1.65,2.59,3.03,3.54,4.14.94,1.11,1.89,2.28,2.83,3.51,1.75,2.17,3.03,4.4,3.86,6.69.83,2.29,1.24,4.61,1.24,6.97,0,4.91-2.08,10.86-6.23,17.84h-1.13c1.32-2.78,2.51-5.58,3.58-8.39,1.06-2.81,1.59-5.49,1.59-8.04s-.66-5.17-1.98-7.86-3.18-4.96-5.56-6.8c-2.38-1.84-4.99-2.86-7.82-3.04v40.08c0,2.03-.65,3.93-1.95,5.7s-3.01,3.2-5.13,4.28c-2.12,1.09-4.46,1.63-7.01,1.63-2.03,0-3.74-.52-5.14-1.56-1.39-1.04-2.09-2.57-2.09-4.6,0-1.51.4-2.96,1.2-4.35.8-1.39,1.86-2.63,3.19-3.72,1.32-1.08,2.77-1.94,4.35-2.55,1.58-.61,3.17-.92,4.78-.92,2.74,0,4.72.54,5.95,1.63V29.67Z"/><path d="m134.14,91.53c1.25,0,2.29.45,3.14,1.36.84.91,1.26,1.92,1.26,3.04s-.42,2.14-1.26,3.04c-.84.91-1.89,1.36-3.14,1.36s-2.29-.45-3.14-1.36c-.84-.9-1.26-1.92-1.26-3.04s.42-2.14,1.26-3.04c.84-.9,1.89-1.36,3.14-1.36Z"/><path d="m68.89,98.6l6.8-24.08c-.99.9-2.11,1.53-3.36,1.91s-2.49.57-3.72.57c-2.03,0-3.73-.54-5.1-1.63-1.37-1.08-2.05-2.64-2.05-4.67,0-1.32.46-2.44,1.38-3.36.92-.92,2.13-1.38,3.65-1.38,1.37,0,2.49.44,3.36,1.31.87.87,1.31,2.04,1.31,3.5,0,1.04-.24,1.96-.71,2.76,0,.28.28.43.85.43,1.94,0,3.78-1.09,5.52-3.26l3.68-13.45c-.99.9-2.11,1.53-3.36,1.91s-2.49.57-3.72.57c-2.03,0-3.73-.54-5.1-1.63-1.37-1.08-2.05-2.64-2.05-4.67,0-1.32.47-2.44,1.42-3.36.94-.92,2.15-1.38,3.61-1.38s2.55.45,3.4,1.35c.85.9,1.27,2.05,1.27,3.47,0,.47-.07.96-.21,1.45-.14.5-.31.93-.5,1.31,0,.28.28.43.85.43,2.6,0,5.07-2.03,7.44-6.09h1.27l-13.38,48.01h-2.55Z"/><path d="m112.04,29.67v59.2c0,2.03-.67,3.92-2.02,5.66-1.35,1.75-3.08,3.15-5.2,4.21s-4.37,1.59-6.73,1.59c-2.17,0-3.92-.55-5.24-1.66-1.32-1.11-1.98-2.61-1.98-4.5,0-1.46.43-2.88,1.27-4.25.85-1.37,1.97-2.61,3.36-3.72,1.39-1.11,2.91-1.98,4.57-2.62,1.65-.64,3.28-.96,4.89-.96,2.03,0,3.78.59,5.24,1.77V29.67h1.84Z"/></svg>`
        },
        {
            id: 'simple_d8_r16',
            type: 'simple',
            name: '附點8+16休 (Dotted 8th+Rest)',
            events: [0], // 前長音，後短休
            svg: `<svg viewBox="0 0 200 130"><path d="m63.59,29.67h1.84c.28,1.94.64,3.65,1.06,5.13.43,1.49,1.04,2.93,1.84,4.32.8,1.39,1.86,2.89,3.19,4.5,1.42,1.65,2.59,3.03,3.54,4.14.94,1.11,1.89,2.28,2.83,3.51,1.75,2.17,3.03,4.4,3.86,6.69.83,2.29,1.24,4.61,1.24,6.97,0,4.91-2.08,10.86-6.23,17.84h-1.13c1.32-2.78,2.51-5.58,3.58-8.39,1.06-2.81,1.59-5.49,1.59-8.04s-.66-5.17-1.98-7.86-3.18-4.96-5.56-6.8c-2.38-1.84-4.99-2.86-7.82-3.04v40.08c0,2.03-.65,3.93-1.95,5.7s-3.01,3.2-5.13,4.28c-2.12,1.09-4.46,1.63-7.01,1.63-2.03,0-3.74-.52-5.14-1.56-1.39-1.04-2.09-2.57-2.09-4.6,0-1.51.4-2.96,1.2-4.35.8-1.39,1.86-2.63,3.19-3.72,1.32-1.08,2.77-1.94,4.35-2.55,1.58-.61,3.17-.92,4.78-.92,2.74,0,4.72.54,5.95,1.63V29.67Z"/><path d="m87.27,91.53c1.25,0,2.29.45,3.14,1.36.84.91,1.26,1.92,1.26,3.04s-.42,2.14-1.26,3.04c-.84.91-1.89,1.36-3.14,1.36s-2.29-.45-3.14-1.36c-.84-.9-1.26-1.92-1.26-3.04s.42-2.14,1.26-3.04c.84-.9,1.89-1.36,3.14-1.36Z"/><path d="m139.95,98.6l6.8-24.08c-.99.9-2.11,1.53-3.36,1.91s-2.49.57-3.72.57c-2.03,0-3.73-.54-5.1-1.63-1.37-1.08-2.05-2.64-2.05-4.67,0-1.32.46-2.44,1.38-3.36.92-.92,2.13-1.38,3.65-1.38,1.37,0,2.49.44,3.36,1.31.87.87,1.31,2.04,1.31,3.5,0,1.04-.24,1.96-.71,2.76,0,.28.28.43.85.43,1.94,0,3.78-1.09,5.52-3.26l3.68-13.45c-.99.9-2.11,1.53-3.36,1.91s-2.49.57-3.72.57c-2.03,0-3.73-.54-5.1-1.63-1.37-1.08-2.05-2.64-2.05-4.67,0-1.32.47-2.44,1.42-3.36.94-.92,2.15-1.38,3.61-1.38s2.55.45,3.4,1.35c.85.9,1.27,2.05,1.27,3.47,0,.47-.07.96-.21,1.45-.14.5-.31.93-.5,1.31,0,.28.28.43.85.43,2.6,0,5.07-2.03,7.44-6.09h1.27l-13.38,48.01h-2.55Z"/></svg>`
        },
        {
            id: 'simple_d8_16',
            type: 'simple',
            name: '附點8+16 (Dotted 8th+16th)',
            events: [0, 0.75], // 前長後短
            svg: `<svg viewBox="0 0 200 130"><g><g><path d="m69.03,29.67v59.2c0,2.03-.67,3.92-2.02,5.66-1.35,1.75-3.08,3.15-5.2,4.21s-4.37,1.59-6.73,1.59c-2.17,0-3.92-.55-5.24-1.66-1.32-1.11-1.98-2.61-1.98-4.5,0-1.46.43-2.88,1.27-4.25.85-1.37,1.97-2.61,3.36-3.72,1.39-1.11,2.91-1.98,4.57-2.62,1.65-.64,3.28-.96,4.89-.96,2.03,0,3.78.59,5.24,1.77V29.67h1.84Z"/><rect x="67.19" y="29.67" width="56.64" height="5.53"/></g><path d="m152.14,29.67v59.2c0,2.03-.67,3.92-2.02,5.66-1.35,1.75-3.08,3.15-5.2,4.21s-4.37,1.59-6.73,1.59c-2.17,0-3.92-.55-5.24-1.66-1.32-1.11-1.98-2.61-1.98-4.5,0-1.46.43-2.88,1.27-4.25.85-1.37,1.97-2.61,3.36-3.72,1.39-1.11,2.91-1.98,4.57-2.62,1.65-.64,3.28-.96,4.89-.96,2.03,0,3.78.59,5.24,1.77V29.67h1.84Z"/><rect x="123.82" y="29.67" width="28.32" height="5.53"/><rect x="123.82" y="40.73" width="28.32" height="5.53"/></g><path d="m80.84,91.53c1.25,0,2.29.45,3.14,1.36.84.91,1.26,1.92,1.26,3.04s-.42,2.14-1.26,3.04c-.84.91-1.89,1.36-3.14,1.36s-2.29-.45-3.14-1.36c-.84-.9-1.26-1.92-1.26-3.04s.42-2.14,1.26-3.04c.84-.9,1.89-1.36,3.14-1.36Z"/></svg>`
        },
        {
            id: 'simple_triplet',
            type: 'simple',
            name: '三連音 (Triplet)',
            events: [0, 0.333, 0.666], // 均分三等份
            svg: `<svg viewBox="0 0 200 130"><defs><style>.cls-1{fill:none;stroke:#000;stroke-miterlimit:10;stroke-width:1.2px}</style></defs><path d="m64.76,29.67v59.2c0,2.03-.67,3.92-2.02,5.66-1.35,1.75-3.08,3.15-5.2,4.21s-4.37,1.59-6.73,1.59c-2.17,0-3.92-.55-5.24-1.66-1.32-1.11-1.98-2.61-1.98-4.5,0-1.46.43-2.88,1.27-4.25.85-1.37,1.97-2.61,3.36-3.72,1.39-1.11,2.91-1.98,4.57-2.62,1.65-.64,3.28-.96,4.89-.96,2.03,0,3.78.59,5.24,1.77V29.67h1.84Z"/><rect x="62.92" y="29.67" width="56.64" height="5.53"/><path d="m147.87,29.67v59.2c0,2.03-.67,3.92-2.02,5.66-1.35,1.75-3.08,3.15-5.2,4.21s-4.37,1.59-6.73,1.59c-2.17,0-3.92-.55-5.24-1.66-1.32-1.11-1.98-2.61-1.98-4.5,0-1.46.43-2.88,1.27-4.25.85-1.37,1.97-2.61,3.36-3.72,1.39-1.11,2.91-1.98,4.57-2.62,1.65-.64,3.28-.96,4.89-.96,2.03,0,3.78.59,5.24,1.77V29.67h1.84Z"/><rect x="119.56" y="29.67" width="28.32" height="5.53"/><path d="m108.29,9.44c0,.72-.2,1.29-.6,1.71-.4.42-.93.7-1.61.84v.06c.86.1,1.49.37,1.91.81.42.44.63,1.01.63,1.72,0,.62-.14,1.17-.43,1.65-.29.48-.73.86-1.34,1.13-.6.27-1.38.4-2.32.4-.56,0-1.07-.04-1.55-.13s-.93-.24-1.37-.46v-1.22c.45.22.93.39,1.45.51.52.12,1.01.19,1.49.19.96,0,1.64-.19,2.07-.56.42-.37.63-.89.63-1.54s-.26-1.15-.78-1.44c-.52-.29-1.26-.44-2.2-.44h-1.03v-1.12h1.04c.87,0,1.54-.18,1.99-.55.45-.37.68-.86.68-1.46,0-.52-.17-.92-.52-1.2-.35-.28-.82-.43-1.42-.43s-1.07.08-1.48.25c-.41.17-.81.38-1.21.64l-.66-.9c.38-.3.85-.56,1.41-.78.56-.22,1.2-.33,1.92-.33,1.11,0,1.94.25,2.48.75.54.5.81,1.13.81,1.89Z"/><polyline class="cls-1" points="54.53 20.11 54.53 12.27 98.46 12.27"/><polyline class="cls-1" points="156.41 20.11 156.41 12.27 112.49 12.27"/><path d="m106.32,29.67v59.2c0,2.03-.67,3.92-2.02,5.66-1.35,1.75-3.08,3.15-5.2,4.21-2.13,1.06-4.37,1.59-6.73,1.59-2.17,0-3.92-.55-5.24-1.66-1.32-1.11-1.98-2.61-1.98-4.5,0-1.46.43-2.88,1.27-4.25.85-1.37,1.97-2.61,3.36-3.72,1.39-1.11,2.91-1.98,4.57-2.62,1.65-.64,3.28-.96,4.89-.96,2.03,0,3.78.59,5.24,1.77V29.67h1.84Z"/></svg>`
        }
    ];

    window.ALL_PATTERNS.push(...patterns);
})();