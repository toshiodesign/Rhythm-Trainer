(function() {
    if (!window.ALL_PATTERNS) window.ALL_PATTERNS = [];

    // --- Part 4: 16分音符與附點變化 (Complex 16ths & Dotted) ---
    const patterns = [
        {
            id: 'simple_16_16_r8',
            type: 'simple',
            name: '16+16+8休 (16th+16th+8th Rest)',
            events: [0, 0.25], // 後半拍休止
            svg: `<svg viewBox="0 0 200 130"><path d="m98.05,98.6l6.8-24.08c-.99.9-2.11,1.53-3.36,1.91s-2.49.57-3.72.57c-2.03,0-3.73-.54-5.1-1.63-1.37-1.08-2.05-2.64-2.05-4.67,0-1.32.46-2.44,1.38-3.36.92-.92,2.13-1.38,3.65-1.38,1.37,0,2.49.44,3.36,1.31.87.87,1.31,2.04,1.31,3.5,0,1.04-.24,1.96-.71,2.76,0,.28.28.43.85.43,1.94,0,3.78-1.09,5.52-3.26l3.68-13.45c-.99.9-2.11,1.53-3.36,1.91s-2.49.57-3.72.57c-2.03,0-3.73-.54-5.1-1.63-1.37-1.08-2.05-2.64-2.05-4.67,0-1.32.47-2.44,1.42-3.36.94-.92,2.15-1.38,3.61-1.38s2.55.45,3.4,1.35c.85.9,1.27,2.05,1.27,3.47,0,.47-.07.96-.21,1.45-.14.5-.31.93-.5,1.31,0,.28.28.43.85.43,2.6,0,5.07-2.03,7.44-6.09h1.27l-13.38,48.01h-2.55Z"/><path d="m62.2,30.37h1.84c.14,1.37.35,2.57.64,3.61.28,1.04.66,1.96,1.13,2.76.8,1.27,1.77,2.37,2.9,3.29,1.13.92,2.43,2.11,3.89,3.58,1.42,1.37,2.81,2.89,4.18,4.57,1.37,1.68,2.51,3.58,3.43,5.7.92,2.12,1.38,4.51,1.38,7.15,0,2.12-.33,4.44-.99,6.94,1.23,1.79,1.84,4.39,1.84,7.79,0,2.27-.31,4.52-.92,6.76-.61,2.24-1.51,4.17-2.69,5.77h-1.13c2.22-4.34,3.33-8.12,3.33-11.33,0-2.6-.73-4.98-2.2-7.15-.94-1.42-1.99-2.68-3.15-3.79-1.16-1.11-2.63-2.25-4.42-3.43-1.79-1.18-4.2-2.52-7.22-4.04v31.16c0,2.03-.67,3.91-2.02,5.63-1.35,1.72-3.08,3.1-5.2,4.14-2.12,1.04-4.32,1.56-6.59,1.56-1.98,0-3.68-.45-5.1-1.35s-2.12-2.29-2.12-4.18c0-2.27.68-4.32,2.05-6.16,1.37-1.84,3.14-3.32,5.31-4.43,2.17-1.11,4.41-1.66,6.73-1.66,2.12,0,3.82.57,5.1,1.7V30.37Zm2.27,13.17c0,2.46.54,4.72,1.63,6.8.38.66,1.14,1.72,2.3,3.19,1.16,1.46,2.54,2.95,4.14,4.46,1.79,1.7,3.38,3.33,4.74,4.89,1.37,1.56,2.17,2.62,2.41,3.19.09-.38.16-.81.21-1.31.05-.5.07-1.05.07-1.66,0-3.59-1.16-6.96-3.47-10.13-2.31-3.16-6.33-6.3-12.04-9.42Z"/><path d="m136.51,31.87h1.79c.28,1.9.62,3.57,1.03,5.03.41,1.45,1.01,2.87,1.79,4.23.78,1.36,1.81,2.83,3.1,4.4,1.38,1.62,2.53,2.97,3.45,4.05.92,1.09,1.84,2.23,2.76,3.43,1.7,2.13,2.95,4.31,3.76,6.55.8,2.24,1.21,4.52,1.21,6.83,0,4.81-2.02,10.63-6.07,17.47h-1.1c1.29-2.73,2.45-5.46,3.48-8.21,1.03-2.75,1.55-5.37,1.55-7.87s-.65-5.06-1.93-7.69-3.09-4.85-5.41-6.65c-2.32-1.8-4.86-2.8-7.62-2.98v39.23c0,1.99-.63,3.85-1.9,5.58s-2.93,3.13-5,4.19c-2.07,1.06-4.34,1.59-6.83,1.59-1.98,0-3.64-.51-5-1.53-1.36-1.02-2.03-2.52-2.03-4.51,0-1.48.39-2.9,1.17-4.26.78-1.36,1.81-2.58,3.1-3.64,1.29-1.06,2.7-1.89,4.24-2.5,1.54-.6,3.09-.9,4.66-.9,2.67,0,4.6.53,5.79,1.59V31.87Z"/></svg>`
        },
        {
            id: 'simple_16_d8r',
            type: 'simple',
            name: '16+附點8休 (16th+Dotted 8th Rest)',
            events: [0], // 0.25後休止
            svg: `<svg viewBox="0 0 200 130"><path d="m69.8,30.02h1.84c.14,1.37.35,2.57.64,3.61.28,1.04.66,1.96,1.13,2.76.8,1.27,1.77,2.37,2.9,3.29,1.13.92,2.43,2.11,3.89,3.58,1.42,1.37,2.81,2.89,4.18,4.57,1.37,1.68,2.51,3.58,3.43,5.7.92,2.12,1.38,4.51,1.38,7.15,0,2.12-.33,4.44-.99,6.94,1.23,1.79,1.84,4.39,1.84,7.79,0,2.27-.31,4.52-.92,6.76-.61,2.24-1.51,4.17-2.69,5.77h-1.13c2.22-4.34,3.33-8.12,3.33-11.33,0-2.6-.73-4.98-2.2-7.15-.94-1.42-1.99-2.68-3.15-3.79-1.16-1.11-2.63-2.25-4.42-3.43-1.79-1.18-4.2-2.52-7.22-4.04v31.16c0,2.03-.67,3.91-2.02,5.63-1.35,1.72-3.08,3.1-5.2,4.14-2.12,1.04-4.32,1.56-6.59,1.56-1.98,0-3.68-.45-5.1-1.35s-2.12-2.29-2.12-4.18c0-2.27.68-4.32,2.05-6.16,1.37-1.84,3.14-3.32,5.31-4.43,2.17-1.11,4.41-1.66,6.73-1.66,2.12,0,3.82.57,5.1,1.7V30.02Zm2.27,13.17c0,2.46.54,4.72,1.63,6.8.38.66,1.14,1.72,2.3,3.19,1.16,1.46,2.54,2.95,4.14,4.46,1.79,1.7,3.38,3.33,4.74,4.89,1.37,1.56,2.17,2.62,2.41,3.19.09-.38.16-.81.21-1.31.05-.5.07-1.05.07-1.66,0-3.59-1.16-6.96-3.47-10.13-2.31-3.16-6.33-6.3-12.04-9.42Z"/><path d="m120.9,81.68l6.8-24.08c-.99.9-2.11,1.53-3.36,1.91-1.25.38-2.49.57-3.72.57-2.03,0-3.73-.54-5.1-1.63-1.37-1.08-2.05-2.64-2.05-4.67,0-1.32.47-2.44,1.42-3.36.94-.92,2.15-1.38,3.61-1.38,1.37,0,2.49.44,3.36,1.31.87.87,1.31,2.04,1.31,3.5,0,1.04-.24,1.96-.71,2.76,0,.28.28.43.85.43,2.59,0,5.07-2.03,7.43-6.09h1.28l-8.57,30.73h-2.55Z"/><path d="m144.99,50.05c1.25,0,2.29.45,3.14,1.36.84.91,1.26,1.92,1.26,3.04s-.42,2.14-1.26,3.04c-.84.91-1.89,1.36-3.14,1.36s-2.29-.45-3.14-1.36c-.84-.9-1.26-1.92-1.26-3.04s.42-2.14,1.26-3.04c.84-.9,1.89-1.36,3.14-1.36Z"/></svg>`
        },
        {
            id: 'simple_16_d8',
            type: 'simple',
            name: '16+附點8 (16th+Dotted 8th)',
            events: [0, 0.25], // 後音長
            svg: `<svg viewBox="0 0 200 130"><g><path d="m74.89,29.67v59.2c0,2.03-.67,3.92-2.02,5.66-1.35,1.75-3.08,3.15-5.2,4.21s-4.37,1.59-6.73,1.59c-2.17,0-3.92-.55-5.24-1.66-1.32-1.11-1.98-2.61-1.98-4.5,0-1.46.43-2.88,1.27-4.25.85-1.37,1.97-2.61,3.36-3.72,1.39-1.11,2.91-1.98,4.57-2.62,1.65-.64,3.28-.96,4.89-.96,2.03,0,3.78.59,5.24,1.77V29.67h1.84Z"/><path d="m129.68,29.67v59.2c0,2.03-.67,3.92-2.02,5.66-1.35,1.75-3.08,3.15-5.2,4.21s-4.37,1.59-6.73,1.59c-2.17,0-3.92-.55-5.24-1.66-1.32-1.11-1.98-2.61-1.98-4.5,0-1.46.43-2.88,1.27-4.25.85-1.37,1.97-2.61,3.36-3.72,1.39-1.11,2.91-1.98,4.57-2.62,1.65-.64,3.28-.96,4.89-.96,2.03,0,3.78.59,5.24,1.77V29.67h1.84Z"/><rect x="73.05" y="29.67" width="56.64" height="5.53"/></g><path d="m141.88,91.53c1.25,0,2.29.45,3.14,1.36.84.91,1.26,1.92,1.26,3.04s-.42,2.14-1.26,3.04c-.84.91-1.89,1.36-3.14,1.36s-2.29-.45-3.14-1.36c-.84-.9-1.26-1.92-1.26-3.04s.42-2.14,1.26-3.04c.84-.9,1.89-1.36,3.14-1.36Z"/><rect x="73.05" y="40.73" width="28.32" height="5.53"/></svg>`
        },
        {
            id: 'simple_r16_8_16',
            type: 'simple',
            name: '16休+8+16 (Rest+8th+16th)',
            events: [0.25, 0.75],
            svg: `<svg viewBox="0 0 200 130"><path d="m44.48,98.6l6.8-24.08c-.99.9-2.11,1.53-3.36,1.91s-2.49.57-3.72.57c-2.03,0-3.73-.54-5.1-1.63-1.37-1.08-2.05-2.64-2.05-4.67,0-1.32.46-2.44,1.38-3.36.92-.92,2.13-1.38,3.65-1.38,1.37,0,2.49.44,3.36,1.31.87.87,1.31,2.04,1.31,3.5,0,1.04-.24,1.96-.71,2.76,0,.28.28.43.85.43,1.94,0,3.78-1.09,5.52-3.26l3.68-13.45c-.99.9-2.11,1.53-3.36,1.91s-2.49.57-3.72.57c-2.03,0-3.73-.54-5.1-1.63-1.37-1.08-2.05-2.64-2.05-4.67,0-1.32.47-2.44,1.42-3.36.94-.92,2.15-1.38,3.61-1.38s2.55.45,3.4,1.35c.85.9,1.27,2.05,1.27,3.47,0,.47-.07.96-.21,1.45-.14.5-.31.93-.5,1.31,0,.28.28.43.85.43,2.6,0,5.07-2.03,7.44-6.09h1.27l-13.38,48.01h-2.55Z"/><g><path d="m88.47,29.67v59.2c0,2.03-.67,3.92-2.02,5.66-1.35,1.75-3.08,3.15-5.2,4.21s-4.37,1.59-6.73,1.59c-2.17,0-3.92-.55-5.24-1.66-1.32-1.11-1.98-2.61-1.98-4.5,0-1.46.43-2.88,1.27-4.25.85-1.37,1.97-2.61,3.36-3.72,1.39-1.11,2.91-1.98,4.57-2.62,1.65-.64,3.28-.96,4.89-.96,2.03,0,3.78.59,5.24,1.77V29.67h1.84Z"/><path d="m162.96,29.67v59.2c0,2.03-.67,3.92-2.02,5.66-1.35,1.75-3.08,3.15-5.2,4.21s-4.37,1.59-6.73,1.59c-2.17,0-3.92-.55-5.24-1.66-1.32-1.11-1.98-2.61-1.98-4.5,0-1.46.43-2.88,1.27-4.25.85-1.37,1.97-2.61,3.36-3.72,1.39-1.11,2.91-1.98,4.57-2.62,1.65-.64,3.28-.96,4.89-.96,2.03,0,3.78.59,5.24,1.77V29.67h1.84Z"/><rect x="87.84" y="29.67" width="75.12" height="5.53"/><rect x="134.64" y="40.73" width="28.32" height="5.53"/></g></svg>`
        },
        {
            id: 'simple_r16_16_8',
            type: 'simple',
            name: '16休+16+8 (Rest+16th+8th)',
            events: [0.25, 0.5],
            svg: `<svg viewBox="0 0 200 130"><g><path d="m98.41,29.67v59.2c0,2.03-.67,3.92-2.02,5.66-1.35,1.75-3.08,3.15-5.2,4.21s-4.37,1.59-6.73,1.59c-2.17,0-3.92-.55-5.24-1.66-1.32-1.11-1.98-2.61-1.98-4.5,0-1.46.43-2.88,1.27-4.25.85-1.37,1.97-2.61,3.36-3.72,1.39-1.11,2.91-1.98,4.57-2.62,1.65-.64,3.28-.96,4.89-.96,2.03,0,3.78.59,5.24,1.77V29.67h1.84Z"/><path d="m153.2,29.67v59.2c0,2.03-.67,3.92-2.02,5.66-1.35,1.75-3.08,3.15-5.2,4.21s-4.37,1.59-6.73,1.59c-2.17,0-3.92-.55-5.24-1.66-1.32-1.11-1.98-2.61-1.98-4.5,0-1.46.43-2.88,1.27-4.25.85-1.37,1.97-2.61,3.36-3.72,1.39-1.11,2.91-1.98,4.57-2.62,1.65-.64,3.28-.96,4.89-.96,2.03,0,3.78.59,5.24,1.77V29.67h1.84Z"/><rect x="96.57" y="29.67" width="56.64" height="5.53"/></g><path d="m54.23,98.6l6.8-24.08c-.99.9-2.11,1.53-3.36,1.91s-2.49.57-3.72.57c-2.03,0-3.73-.54-5.1-1.63-1.37-1.08-2.05-2.64-2.05-4.67,0-1.32.46-2.44,1.38-3.36.92-.92,2.13-1.38,3.65-1.38,1.37,0,2.49.44,3.36,1.31.87.87,1.31,2.04,1.31,3.5,0,1.04-.24,1.96-.71,2.76,0,.28.28.43.85.43,1.94,0,3.78-1.09,5.52-3.26l3.68-13.45c-.99.9-2.11,1.53-3.36,1.91s-2.49.57-3.72.57c-2.03,0-3.73-.54-5.1-1.63-1.37-1.08-2.05-2.64-2.05-4.67,0-1.32.47-2.44,1.42-3.36.94-.92,2.15-1.38,3.61-1.38s2.55.45,3.4,1.35c.85.9,1.27,2.05,1.27,3.47,0,.47-.07.96-.21,1.45-.14.5-.31.93-.5,1.31,0,.28.28.43.85.43,2.6,0,5.07-2.03,7.44-6.09h1.27l-13.38,48.01h-2.55Z"/><rect x="96.57" y="40.73" width="28.32" height="5.53"/></svg>`
        }
    ];

    window.ALL_PATTERNS.push(...patterns);
})();