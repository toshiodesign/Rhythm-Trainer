(function() {
    if (!window.ALL_PATTERNS) window.ALL_PATTERNS = [];

    // --- Part 6: 三連音變化 (Triplet Variations) ---
    const patterns = [
        {
            id: 'simple_3rd_3rd_r3rd',
            type: 'simple',
            name: '三連音: 2音+休 (Note-Note-Rest)',
            events: [0, 0.333], // 第3個點休止
            svg: `<svg viewBox="0 0 200 130"><defs><style>.cls-1{fill:none;stroke:#000;stroke-miterlimit:10;stroke-width:1.2px}</style></defs><path d="m145.21,92.76l6.8-24.08c-.99.9-2.11,1.53-3.36,1.91-1.25.38-2.49.57-3.72.57-2.03,0-3.73-.54-5.1-1.63-1.37-1.08-2.05-2.64-2.05-4.67,0-1.32.47-2.44,1.42-3.36.94-.92,2.15-1.38,3.61-1.38,1.37,0,2.49.44,3.36,1.31.87.87,1.31,2.04,1.31,3.5,0,1.04-.24,1.96-.71,2.76,0,.28.28.43.85.43,2.59,0,5.07-2.03,7.43-6.09h1.28l-8.57,30.73h-2.55Z"/><path d="m64.76,41.1v59.2c0,2.03-.67,3.92-2.02,5.66-1.35,1.75-3.08,3.15-5.2,4.21s-4.37,1.59-6.73,1.59c-2.17,0-3.92-.55-5.24-1.66-1.32-1.11-1.98-2.61-1.98-4.5,0-1.46.43-2.88,1.27-4.25.85-1.37,1.97-2.61,3.36-3.72,1.39-1.11,2.91-1.98,4.57-2.62,1.65-.64,3.28-.96,4.89-.96,2.03,0,3.78.59,5.24,1.77v-54.74h1.84Z"/><rect x="62.92" y="41.1" width="43.4" height="5.53"/><path d="m108.29,20.87c0,.72-.2,1.29-.6,1.71-.4.42-.93.7-1.61.84v.06c.86.1,1.49.37,1.91.81.42.44.63,1.01.63,1.72,0,.62-.14,1.17-.43,1.65-.29.48-.73.86-1.34,1.13-.6.27-1.38.4-2.32.4-.56,0-1.07-.04-1.55-.13s-.93-.24-1.37-.46v-1.22c.45.22.93.39,1.45.51.52.12,1.01.19,1.49.19.96,0,1.64-.19,2.07-.56.42-.37.63-.89.63-1.54s-.26-1.15-.78-1.44c-.52-.29-1.26-.44-2.2-.44h-1.03v-1.12h1.04c.87,0,1.54-.18,1.99-.55.45-.37.68-.86.68-1.46,0-.52-.17-.92-.52-1.2-.35-.28-.82-.43-1.42-.43s-1.07.08-1.48.25c-.41.17-.81.38-1.21.64l-.66-.9c.38-.3.85-.56,1.41-.78.56-.22,1.2-.33,1.92-.33,1.11,0,1.94.25,2.48.75.54.5.81,1.13.81,1.89Z"/><polyline class="cls-1" points="54.53 31.54 54.53 23.71 98.46 23.71"/><polyline class="cls-1" points="156.41 31.54 156.41 23.71 112.49 23.71"/><path d="m106.32,41.1v59.2c0,2.03-.67,3.92-2.02,5.66-1.35,1.75-3.08,3.15-5.2,4.21s-4.37,1.59-6.73,1.59c-2.17,0-3.92-.55-5.24-1.66-1.32-1.11-1.98-2.61-1.98-4.5,0-1.46.43-2.88,1.27-4.25.85-1.37,1.97-2.61,3.36-3.72,1.39-1.11,2.91-1.98,4.57-2.62,1.65-.64,3.28-.96,4.89-.96,2.03,0,3.78.59,5.24,1.77v-54.74h1.84Z"/></svg>`
        },
        {
            id: 'simple_3rd_r3rd_r3rd',
            type: 'simple',
            name: '三連音: 1音+2休 (Note-Rest-Rest)',
            events: [0], // 只有第一音
            svg: `<svg viewBox="0 0 200 130"><defs><style>.cls-1{fill:none;stroke:#000;stroke-miterlimit:10;stroke-width:1.2px}</style></defs><path d="m106.49,92.76l6.8-24.08c-.99.9-2.11,1.53-3.36,1.91-1.25.38-2.49.57-3.72.57-2.03,0-3.73-.54-5.1-1.63-1.37-1.08-2.05-2.64-2.05-4.67,0-1.32.47-2.44,1.42-3.36.94-.92,2.15-1.38,3.61-1.38,1.37,0,2.49.44,3.36,1.31.87.87,1.31,2.04,1.31,3.5,0,1.04-.24,1.96-.71,2.76,0,.28.28.43.85.43,2.59,0,5.07-2.03,7.43-6.09h1.28l-8.57,30.73h-2.55Z"/><path d="m144.93,92.76l6.8-24.08c-.99.9-2.11,1.53-3.36,1.91-1.25.38-2.49.57-3.72.57-2.03,0-3.73-.54-5.1-1.63-1.37-1.08-2.05-2.64-2.05-4.67,0-1.32.47-2.44,1.42-3.36.94-.92,2.15-1.38,3.61-1.38,1.37,0,2.49.44,3.36,1.31.87.87,1.31,2.04,1.31,3.5,0,1.04-.24,1.96-.71,2.76,0,.28.28.43.85.43,2.59,0,5.07-2.03,7.43-6.09h1.28l-8.57,30.73h-2.55Z"/><path d="m108.01,20.87c0,.72-.2,1.29-.6,1.71-.4.42-.93.7-1.61.84v.06c.86.1,1.49.37,1.91.81.42.44.63,1.01.63,1.72,0,.62-.14,1.17-.43,1.65-.29.48-.73.86-1.34,1.13-.6.27-1.38.4-2.32.4-.56,0-1.07-.04-1.55-.13s-.93-.24-1.37-.46v-1.22c.45.22.93.39,1.45.51.52.12,1.01.19,1.49.19.96,0,1.64-.19,2.07-.56.42-.37.63-.89.63-1.54s-.26-1.15-.78-1.44c-.52-.29-1.26-.44-2.2-.44h-1.03v-1.12h1.04c.87,0,1.54-.18,1.99-.55.45-.37.68-.86.68-1.46,0-.52-.17-.92-.52-1.2-.35-.28-.82-.43-1.42-.43s-1.07.08-1.48.25c-.41.17-.81.38-1.21.64l-.66-.9c.38-.3.85-.56,1.41-.78.56-.22,1.2-.33,1.92-.33,1.11,0,1.94.25,2.48.75.54.5.81,1.13.81,1.89Z"/><polyline class="cls-1" points="54.25 31.54 54.25 23.71 98.18 23.71"/><polyline class="cls-1" points="156.13 31.54 156.13 23.71 112.21 23.71"/><path d="m62.83,42.6h1.79c.28,1.9.62,3.57,1.03,5.03.41,1.45,1.01,2.87,1.79,4.23.78,1.36,1.81,2.83,3.1,4.4,1.38,1.62,2.53,2.97,3.45,4.05.92,1.09,1.84,2.23,2.76,3.43,1.7,2.13,2.95,4.31,3.76,6.55.8,2.24,1.21,4.52,1.21,6.83,0,4.81-2.02,10.63-6.07,17.47h-1.1c1.29-2.73,2.45-5.46,3.48-8.21,1.03-2.75,1.55-5.37,1.55-7.87s-.65-5.06-1.93-7.69-3.09-4.85-5.41-6.65c-2.32-1.8-4.86-2.8-7.62-2.98v39.23c0,1.99-.63,3.85-1.9,5.58s-2.93,3.13-5,4.19c-2.07,1.06-4.34,1.59-6.83,1.59-1.98,0-3.64-.51-5-1.53-1.36-1.02-2.03-2.52-2.03-4.51,0-1.48.39-2.9,1.17-4.26.78-1.36,1.81-2.58,3.1-3.64,1.29-1.06,2.7-1.89,4.24-2.5,1.54-.6,3.09-.9,4.66-.9,2.67,0,4.6.53,5.79,1.59v-53.44Z"/></svg>`
        },
        {
            id: 'simple_3rd_r3rd_3rd',
            type: 'simple',
            name: '三連音: 1音+休+3音 (Note-Rest-Note)',
            events: [0, 0.666], // 中間休止
            svg: `<svg viewBox="0 0 200 130"><defs><style>.cls-1{fill:none;stroke:#000;stroke-miterlimit:10;stroke-width:1.2px}</style></defs><polyline class="cls-1" points="54.53 31.54 54.53 23.71 98.46 23.71"/><polyline class="cls-1" points="156.41 31.54 156.41 23.71 112.49 23.71"/><path d="m64.76,41.1v59.2c0,2.03-.67,3.92-2.02,5.66-1.35,1.75-3.08,3.15-5.2,4.21s-4.37,1.59-6.73,1.59c-2.17,0-3.92-.55-5.24-1.66-1.32-1.11-1.98-2.61-1.98-4.5,0-1.46.43-2.88,1.27-4.25.85-1.37,1.97-2.61,3.36-3.72,1.39-1.11,2.91-1.98,4.57-2.62,1.65-.64,3.28-.96,4.89-.96,2.03,0,3.78.59,5.24,1.77v-54.74h1.84Z"/><rect x="62.92" y="41.1" width="56.64" height="5.53"/><g><path d="m96.62,109.08l6.8-24.08c-.99.9-2.11,1.53-3.36,1.91-1.25.38-2.49.57-3.72.57-2.03,0-3.73-.54-5.1-1.63-1.37-1.08-2.05-2.64-2.05-4.67,0-1.32.47-2.44,1.42-3.36.94-.92,2.15-1.38,3.61-1.38,1.37,0,2.49.44,3.36,1.31.87.87,1.31,2.04,1.31,3.5,0,1.04-.24,1.96-.71,2.76,0,.28.28.43.85.43,2.59,0,5.07-2.03,7.43-6.09h1.28l-8.57,30.73h-2.55Z"/><path d="m147.87,41.1v59.2c0,2.03-.67,3.92-2.02,5.66-1.35,1.75-3.08,3.15-5.2,4.21s-4.37,1.59-6.73,1.59c-2.17,0-3.92-.55-5.24-1.66-1.32-1.11-1.98-2.61-1.98-4.5,0-1.46.43-2.88,1.27-4.25.85-1.37,1.97-2.61,3.36-3.72,1.39-1.11,2.91-1.98,4.57-2.62,1.65-.64,3.28-.96,4.89-.96,2.03,0,3.78.59,5.24,1.77v-54.74h1.84Z"/></g><rect x="119.56" y="41.1" width="28.32" height="5.53"/><path d="m108.29,20.87c0,.72-.2,1.29-.6,1.71-.4.42-.93.7-1.61.84v.06c.86.1,1.49.37,1.91.81.42.44.63,1.01.63,1.72,0,.62-.14,1.17-.43,1.65-.29.48-.73.86-1.34,1.13-.6.27-1.38.4-2.32.4-.56,0-1.07-.04-1.55-.13s-.93-.24-1.37-.46v-1.22c.45.22.93.39,1.45.51.52.12,1.01.19,1.49.19.96,0,1.64-.19,2.07-.56.42-.37.63-.89.63-1.54s-.26-1.15-.78-1.44c-.52-.29-1.26-.44-2.2-.44h-1.03v-1.12h1.04c.87,0,1.54-.18,1.99-.55.45-.37.68-.86.68-1.46,0-.52-.17-.92-.52-1.2-.35-.28-.82-.43-1.42-.43s-1.07.08-1.48.25c-.41.17-.81.38-1.21.64l-.66-.9c.38-.3.85-.56,1.41-.78.56-.22,1.2-.33,1.92-.33,1.11,0,1.94.25,2.48.75.54.5.81,1.13.81,1.89Z"/></svg>`
        },
        {
            id: 'simple_r3rd_3rd_r3rd',
            type: 'simple',
            name: '三連音: 休+2音+休 (Rest-Note-Rest)',
            events: [0.333], // 只有中間音
            svg: `<svg viewBox="0 0 200 130"><defs><style>.cls-1{fill:none;stroke:#000;stroke-miterlimit:10;stroke-width:1.2px}</style></defs><path d="m138.74,92.76l6.8-24.08c-.99.9-2.11,1.53-3.36,1.91-1.25.38-2.49.57-3.72.57-2.03,0-3.73-.54-5.1-1.63-1.37-1.08-2.05-2.64-2.05-4.67,0-1.32.47-2.44,1.42-3.36.94-.92,2.15-1.38,3.61-1.38,1.37,0,2.49.44,3.36,1.31.87.87,1.31,2.04,1.31,3.5,0,1.04-.24,1.96-.71,2.76,0,.28.28.43.85.43,2.59,0,5.07-2.03,7.43-6.09h1.28l-8.57,30.73h-2.55Z"/><path d="m56.58,92.76l6.8-24.08c-.99.9-2.11,1.53-3.36,1.91-1.25.38-2.49.57-3.72.57-2.03,0-3.73-.54-5.1-1.63-1.37-1.08-2.05-2.64-2.05-4.67,0-1.32.47-2.44,1.42-3.36.94-.92,2.15-1.38,3.61-1.38,1.37,0,2.49.44,3.36,1.31.87.87,1.31,2.04,1.31,3.5,0,1.04-.24,1.96-.71,2.76,0,.28.28.43.85.43,2.59,0,5.07-2.03,7.43-6.09h1.28l-8.57,30.73h-2.55Z"/><path d="m102.81,20.87c0,.72-.2,1.29-.6,1.71-.4.42-.93.7-1.61.84v.06c.86.1,1.49.37,1.91.81.42.44.63,1.01.63,1.72,0,.62-.14,1.17-.43,1.65-.29.48-.73.86-1.34,1.13-.6.27-1.38.4-2.32.4-.56,0-1.07-.04-1.55-.13s-.93-.24-1.37-.46v-1.22c.45.22.93.39,1.45.51.52.12,1.01.19,1.49.19.96,0,1.64-.19,2.07-.56.42-.37.63-.89.63-1.54s-.26-1.15-.78-1.44c-.52-.29-1.26-.44-2.2-.44h-1.03v-1.12h1.04c.87,0,1.54-.18,1.99-.55.45-.37.68-.86.68-1.46,0-.52-.17-.92-.52-1.2-.35-.28-.82-.43-1.42-.43s-1.07.08-1.48.25c-.41.17-.81.38-1.21.64l-.66-.9c.38-.3.85-.56,1.41-.78.56-.22,1.2-.33,1.92-.33,1.11,0,1.94.25,2.48.75.54.5.81,1.13.81,1.89Z"/><polyline class="cls-1" points="49.06 31.54 49.06 23.71 92.98 23.71"/><polyline class="cls-1" points="150.94 31.54 150.94 23.71 107.02 23.71"/><path d="m98.6,42.6h1.79c.28,1.9.62,3.57,1.03,5.03.41,1.45,1.01,2.87,1.79,4.23.78,1.36,1.81,2.83,3.1,4.4,1.38,1.62,2.53,2.97,3.45,4.05.92,1.09,1.84,2.23,2.76,3.43,1.7,2.13,2.95,4.31,3.76,6.55.8,2.24,1.21,4.52,1.21,6.83,0,4.81-2.02,10.63-6.07,17.47h-1.1c1.29-2.73,2.45-5.46,3.48-8.21,1.03-2.75,1.55-5.37,1.55-7.87s-.65-5.06-1.93-7.69-3.09-4.85-5.41-6.65c-2.32-1.8-4.86-2.8-7.62-2.98v39.23c0,1.99-.63,3.85-1.9,5.58s-2.93,3.13-5,4.19c-2.07,1.06-4.34,1.59-6.83,1.59-1.98,0-3.64-.51-5-1.53-1.36-1.02-2.03-2.52-2.03-4.51,0-1.48.39-2.9,1.17-4.26.78-1.36,1.81-2.58,3.1-3.64,1.29-1.06,2.7-1.89,4.24-2.5,1.54-.6,3.09-.9,4.66-.9,2.67,0,4.6.53,5.79,1.59v-53.44Z"/></svg>`
        },
        {
            id: 'simple_r3rd_3rd_3rd',
            type: 'simple',
            name: '三連音: 休+2音 (Rest-Note-Note)',
            events: [0.333, 0.666], // 第一音休止
            svg: `<svg viewBox="0 0 200 130"><defs><style>.cls-1{fill:none;stroke:#000;stroke-miterlimit:10;stroke-width:1.2px}</style></defs><path d="m56.58,92.76l6.8-24.08c-.99.9-2.11,1.53-3.36,1.91-1.25.38-2.49.57-3.72.57-2.03,0-3.73-.54-5.1-1.63-1.37-1.08-2.05-2.64-2.05-4.67,0-1.32.47-2.44,1.42-3.36.94-.92,2.15-1.38,3.61-1.38,1.37,0,2.49.44,3.36,1.31.87.87,1.31,2.04,1.31,3.5,0,1.04-.24,1.96-.71,2.76,0,.28.28.43.85.43,2.59,0,5.07-2.03,7.43-6.09h1.28l-8.57,30.73h-2.55Z"/><path d="m102.81,20.87c0,.72-.2,1.29-.6,1.71-.4.42-.93.7-1.61.84v.06c.86.1,1.49.37,1.91.81.42.44.63,1.01.63,1.72,0,.62-.14,1.17-.43,1.65-.29.48-.73.86-1.34,1.13-.6.27-1.38.4-2.32.4-.56,0-1.07-.04-1.55-.13s-.93-.24-1.37-.46v-1.22c.45.22.93.39,1.45.51.52.12,1.01.19,1.49.19.96,0,1.64-.19,2.07-.56.42-.37.63-.89.63-1.54s-.26-1.15-.78-1.44c-.52-.29-1.26-.44-2.2-.44h-1.03v-1.12h1.04c.87,0,1.54-.18,1.99-.55.45-.37.68-.86.68-1.46,0-.52-.17-.92-.52-1.2-.35-.28-.82-.43-1.42-.43s-1.07.08-1.48.25c-.41.17-.81.38-1.21.64l-.66-.9c.38-.3.85-.56,1.41-.78.56-.22,1.2-.33,1.92-.33,1.11,0,1.94.25,2.48.75.54.5.81,1.13.81,1.89Z"/><polyline class="cls-1" points="49.06 31.54 49.06 23.71 92.98 23.71"/><polyline class="cls-1" points="150.94 31.54 150.94 23.71 107.02 23.71"/><g><path d="m100.91,41.1v59.2c0,2.03-.67,3.92-2.02,5.66-1.35,1.75-3.08,3.15-5.2,4.21s-4.37,1.59-6.73,1.59c-2.17,0-3.92-.55-5.24-1.66-1.32-1.11-1.98-2.61-1.98-4.5,0-1.46.43-2.88,1.27-4.25.85-1.37,1.97-2.61,3.36-3.72,1.39-1.11,2.91-1.98,4.57-2.62,1.65-.64,3.28-.96,4.89-.96,2.03,0,3.78.59,5.24,1.77v-54.74h1.84Z"/><rect x="99.07" y="41.1" width="43.4" height="5.53"/><path d="m142.46,41.1v59.2c0,2.03-.67,3.92-2.02,5.66-1.35,1.75-3.08,3.15-5.2,4.21s-4.37,1.59-6.73,1.59c-2.17,0-3.92-.55-5.24-1.66-1.32-1.11-1.98-2.61-1.98-4.5,0-1.46.43-2.88,1.27-4.25.85-1.37,1.97-2.61,3.36-3.72,1.39-1.11,2.91-1.98,4.57-2.62,1.65-.64,3.28-.96,4.89-.96,2.03,0,3.78.59,5.24,1.77v-54.74h1.84Z"/></g></svg>`
        },
        {
            id: 'simple_r3rd_r3rd_3rd',
            type: 'simple',
            name: '三連音: 2休+1音 (Rest-Rest-Note)',
            events: [0.666], // 只有最後一音
            svg: `<svg viewBox="0 0 200 130"><defs><style>.cls-1{fill:none;stroke:#000;stroke-miterlimit:10;stroke-width:1.2px}</style></defs><path d="m97.02,92.76l6.8-24.08c-.99.9-2.11,1.53-3.36,1.91-1.25.38-2.49.57-3.72.57-2.03,0-3.73-.54-5.1-1.63-1.37-1.08-2.05-2.64-2.05-4.67,0-1.32.47-2.44,1.42-3.36.94-.92,2.15-1.38,3.61-1.38,1.37,0,2.49.44,3.36,1.31.87.87,1.31,2.04,1.31,3.5,0,1.04-.24,1.96-.71,2.76,0,.28.28.43.85.43,2.59,0,5.07-2.03,7.43-6.09h1.28l-8.57,30.73h-2.55Z"/><path d="m52.29,92.76l6.8-24.08c-.99.9-2.11,1.53-3.36,1.91-1.25.38-2.49.57-3.72.57-2.03,0-3.73-.54-5.1-1.63-1.37-1.08-2.05-2.64-2.05-4.67,0-1.32.47-2.44,1.42-3.36.94-.92,2.15-1.38,3.61-1.38,1.37,0,2.49.44,3.36,1.31.87.87,1.31,2.04,1.31,3.5,0,1.04-.24,1.96-.71,2.76,0,.28.28.43.85.43,2.59,0,5.07-2.03,7.43-6.09h1.28l-8.57,30.73h-2.55Z"/><path d="m98.53,20.87c0,.72-.2,1.29-.6,1.71-.4.42-.93.7-1.61.84v.06c.86.1,1.49.37,1.91.81.42.44.63,1.01.63,1.72,0,.62-.14,1.17-.43,1.65-.29.48-.73.86-1.34,1.13-.6.27-1.38.4-2.32.4-.56,0-1.07-.04-1.55-.13s-.93-.24-1.37-.46v-1.22c.45.22.93.39,1.45.51.52.12,1.01.19,1.49.19.96,0,1.64-.19,2.07-.56.42-.37.63-.89.63-1.54s-.26-1.15-.78-1.44c-.52-.29-1.26-.44-2.2-.44h-1.03v-1.12h1.04c.87,0,1.54-.18,1.99-.55.45-.37.68-.86.68-1.46,0-.52-.17-.92-.52-1.2-.35-.28-.82-.43-1.42-.43s-1.07.08-1.48.25c-.41.17-.81.38-1.21.64l-.66-.9c.38-.3.85-.56,1.41-.78.56-.22,1.2-.33,1.92-.33,1.11,0,1.94.25,2.48.75.54.5.81,1.13.81,1.89Z"/><polyline class="cls-1" points="44.77 31.54 44.77 23.71 88.7 23.71"/><polyline class="cls-1" points="146.65 31.54 146.65 23.71 102.73 23.71"/><path d="m136.33,42.6h1.79c.28,1.9.62,3.57,1.03,5.03.41,1.45,1.01,2.87,1.79,4.23.78,1.36,1.81,2.83,3.1,4.4,1.38,1.62,2.53,2.97,3.45,4.05.92,1.09,1.84,2.23,2.76,3.43,1.7,2.13,2.95,4.31,3.76,6.55.8,2.24,1.21,4.52,1.21,6.83,0,4.81-2.02,10.63-6.07,17.47h-1.1c1.29-2.73,2.45-5.46,3.48-8.21,1.03-2.75,1.55-5.37,1.55-7.87s-.65-5.06-1.93-7.69c-1.29-2.63-3.09-4.85-5.41-6.65-2.32-1.8-4.86-2.8-7.62-2.98v39.23c0,1.99-.63,3.85-1.9,5.58s-2.93,3.13-5,4.19c-2.07,1.06-4.34,1.59-6.83,1.59-1.98,0-3.64-.51-5-1.53-1.36-1.02-2.03-2.52-2.03-4.51,0-1.48.39-2.9,1.17-4.26.78-1.36,1.81-2.58,3.1-3.64,1.29-1.06,2.7-1.89,4.24-2.5,1.54-.6,3.09-.9,4.66-.9,2.67,0,4.6.53,5.79,1.59v-53.44Z"/></svg>`
        }
    ];

    window.ALL_PATTERNS.push(...patterns);
})();